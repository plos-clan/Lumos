# Lumos Project AI Instructions

本文件为 AI 助手提供 Lumos 项目的背景信息、设计原则及开发规范，以确保生成的代码和文档与项目愿景保持一致。

## 1. 项目定位

Lumos (光耀) 是一门系统级编程语言，侧重于**高性能**、**显式安全**与**现代化语法**。目前项目处于**纯文档设计阶段**，源码部分已废弃。

## 2. 核心语法规范

### 2.1 函数纯度 (Function Purity)

禁止使用通用的 `fn` 关键字，必须根据纯度选择以下之一：

- `def`: **纯函数**。无副作用，输入相同输出必相同。只能调用 `def`。
- `fun`: **逻辑纯函数**。允许内部副作用（如局部变量修改），但对外部透明。可以调用 `def` 和 `fun`。
- `act`: **副作用函数**。允许 IO、全局状态修改等。可以调用所有类型函数。
- **修饰符与标记**:
  - `unsafe fun`: 在 `fun` 中执行 `act` 操作的逃生舱。
  - `once! act` / `once? act`: 确保动作仅执行一次（报错/忽略）。
  - `-` 标记: 用于不返回的函数（如 `act fatal() - { exit(1); }`）。

### 2.2 变量与类型

- `unit`: 替代 `void`，表示无类型或空值。
- `var`: 完全可变（隐含 `mut` 类型修饰）。
- `val`: 逻辑不可变（默认，允许内部可变性）。
- `imv`: 物理不可变（隐含 `imm` 类型修饰，存放在只读内存）。
- `lit`: 编译期常量。
- `late`: 手动延迟初始化。
- `lazy`: 线程安全的懒加载初始化。

### 2.3 逻辑控制

- `assume <cond>`: 静态假设条件成立，用于编译器优化（若不成立则为 UB）。
- `where <cond>`: 用于函数参数或泛型的约束。

## 3. 文档编写规范

- **路径引用**: 始终使用相对路径。
- **代码块**: 使用 `lumos` 作为语言标识符。
- **术语一致性**: 确保使用最新的关键字（如 `def`/`fun`/`act` 而非 `fn`）。

## 4. AI 协作指南

- **任务重点**: 协助完善 `docs/` 目录下的语言规范。
- **禁止行为**: 不要尝试修复 `src/` 或 `include/` 下的旧 C++ 代码，除非明确要求。
- **风格要求**: 保持 impersonal、专业且简洁的中文回复。
- **参考资料**: 优先参考 `docs/grammar/keyword.md` 和 `docs/grammar/function.md`。

## 5. 目录索引

- `docs/lexical/`: 词法定义（注释、字面量）。
- `docs/grammar/`: 语法核心（变量、函数、控制流）。
- `docs/std/`: 标准库设计。
- `docs/ast/`: 编译器前端设计。
