
# 变量

## 变量声明 `var`

使用类似 C 的形式 `类型 变量名 = 表达式;` 声明并初始化一个变量。<br>
也可以使用类似 C++ 的类型推导 `var 变量名 = 表达式;` 进行声明并初始化。<br>
*注意不是 `auto`*

```lumos
var      a = 初始化表达式;
类型     b = 初始化表达式;
var 类型 c = 初始化表达式;
```

```lumos
var     a = 1; // 这三个等效
int     b = 1;
var int c = 1;
```

允许的优化：对于一个变量，取到的值可以是

- 编译时能够确定的值（非 `volatile`）
- 上次修改后缓存的值（非 `volatile`）
- 对应内存地址当前的值

## 不可变变量声明 `val`

使用 `val` 关键字声明常量。方法与 C/C++ 的 `const` 类似。

```lumos
val      常量名 = 值;
val 类型 常量名 = 值;
```

常量设计上在整个生命周期中不可变，但实际上可以强行修改，但进行修改时可能会因编译器的优化策略导致不可预测的结果。

```lumos
val a = 1;     // 定义常量
println(a);    // 输出 1
*(int*)&a = 2; // 强行修改为 2
println(a);    // 由于编译器的优化策略，可能输出 1 或 2
```

允许的优化：对于一个常量，取到的值可以是

- 编译时能够确定的值（非 `volatile`）
- 作用域内任意位置缓存的值（非 `volatile`）
- 对应内存地址当前的值

## 初始化

变量类型与表达式类型不同时变量初始化被视为显式类型转换。但之后的赋值只允许隐式类型转换。
